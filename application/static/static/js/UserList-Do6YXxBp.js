var g=(_,p,s)=>new Promise((a,o)=>{var m=t=>{try{r(s.next(t))}catch(e){o(e)}},c=t=>{try{r(s.throw(t))}catch(e){o(e)}},r=t=>t.done?a(t.value):Promise.resolve(t.value).then(m,c);r((s=s.apply(_,p)).next())});import{P as B}from"./Page-DeLWWzfO.js";import{B as P}from"./setting-bzqi1Zug.js";import{A as x,b as u,o as U,I as f,a1 as S,y as I,al as V,w as L,M as k,P as l,Y as d,$ as w,X as T,aG as C,aj as h}from"./index-DlZhamGx.js";import{d as M,_ as $}from"./RoleSelect.vue_vue_type_script_setup_true_lang-Jpq_OAnR.js";const A=x({__name:"DepartmentSelect",props:{placeholder:{default:"请选择部门",type:String}},emits:["changeValue"],setup(_,{emit:p}){const s={label:"name",value:"id"},a=u(null),o=u(null),m=_;U(()=>{c()});const c=()=>g(null,null,function*(){const{data:e}=yield M.getDepartmentList();a.value=e}),r=p,t=e=>{r("changeValue",e)};return(e,b)=>{const v=f("el-cascader");return I(),S(v,{modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=i=>o.value=i),options:a.value,props:s,placeholder:m.placeholder,clearable:"",onChange:t},null,8,["modelValue","options","placeholder"])}}}),D={class:"app-container"},E={class:"filter-container"},z={class:"flex justify-around"},F=x({__name:"UserList",setup(_){const p=u(null),s=u(0),a=u({account:null,name:null,deptId:null,roleId:null,phoneNumber:null,email:null,position:null,principal:null,pageSize:10,pageNumber:1});u(null),U(()=>{o()});function o(){return g(this,null,function*(){const{data:t,total:e}=yield V.getUserList(a.value);p.value=t,s.value=e})}function m(t){C.prompt("请确认是否重置密码，默认重置密码为“123456”，如需修改请重新输入","重置密码",{confirmButtonText:"确认",cancelButtonText:"取消",inputValue:"123456",inputType:"password",inputPattern:/\S+/,inputErrorMessage:"输入密码不能为空"}).then(b=>g(null,[b],function*({value:e}){yield V.resetPassword({resetAccountId:t.id,resetPassword:e.trim()}),h.success("重置密码成功!"),yield o()})).catch(()=>{h.info("已取消操作!")})}function c(t){C.confirm("是否删除该用户?","提示",{type:"warning"}).then(()=>g(null,null,function*(){yield V.deleteUser({id:t.id}),h.success("操作成功!"),yield o()})).catch(()=>{h.info("已取消操作!")})}const r=t=>{t?a.value.deptId=t[(t==null?void 0:t.length)-1]:a.value.deptId=t};return(t,e)=>{const b=f("el-input"),v=f("el-button"),i=f("el-table-column"),y=f("el-link");return I(),L("div",D,[k("div",E,[l(b,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.name=n),placeholder:"请输入用户名",clearable:"",class:"filter-item width"},null,8,["modelValue"]),l($,{modelValue:a.value.roleId,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.roleId=n),class:"filter-item width"},null,8,["modelValue"]),l(A,{modelValue:a.value.deptId,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.deptId=n),class:"filter-item width",onChange:r},null,8,["modelValue"]),l(v,{class:"filter-item",type:"primary",onClick:o},{default:d(()=>[...e[5]||(e[5]=[w("查询",-1)])]),_:1})]),l(P,{data:p.value},{default:d(()=>[l(i,{type:"index",label:"序号",align:"center",width:"60"}),l(i,{prop:"name",label:"用户名",align:"center","min-width":"120"}),l(i,{prop:"account",label:"账号",align:"center","min-width":"120"}),l(i,{prop:"deptName",label:"部门名称",align:"center","min-width":"120"}),l(i,{prop:"phoneNumber",label:"手机号码",align:"center","min-width":"150"}),l(i,{prop:"email",label:"邮箱",align:"center","min-width":"170"}),l(i,{prop:"roleName",label:"角色",align:"center","min-width":"120"}),l(i,{prop:"work",label:"在职状态",align:"center","min-width":"120"},{default:d(({row:n})=>[w(T((n==null?void 0:n.work)===1?"在职":"离职"),1)]),_:1}),l(i,{label:"操作",align:"center","min-width":"210",fixed:"right"},{default:d(({row:n})=>[k("div",z,[l(y,{type:"primary",onClick:N=>m(n)},{default:d(()=>[...e[6]||(e[6]=[w("重置密码",-1)])]),_:1},8,["onClick"]),l(y,{type:"danger",onClick:N=>c(n)},{default:d(()=>[...e[7]||(e[7]=[w("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]),l(B,{limit:a.value.pageSize,"onUpdate:limit":e[3]||(e[3]=n=>a.value.pageSize=n),page:a.value.pageNumber,"onUpdate:page":e[4]||(e[4]=n=>a.value.pageNumber=n),total:s.value,onPagination:o},null,8,["limit","page","total"])])}}});export{F as default};
