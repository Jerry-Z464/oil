var pe=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var j=(f,o,r)=>o in f?pe(f,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):f[o]=r,Q=(f,o)=>{for(var r in o||(o={}))ce.call(o,r)&&j(f,r,o[r]);if(Z)for(var r of Z(o))fe.call(o,r)&&j(f,r,o[r]);return f};var s=(f,o,r)=>new Promise((w,p)=>{var C=d=>{try{v(r.next(d))}catch(_){p(_)}},N=d=>{try{v(r.throw(d))}catch(_){p(_)}},v=d=>d.done?w(d.value):Promise.resolve(d.value).then(C,N);v((r=r.apply(f,o)).next())});import{A as O,k as S,b as c,o as H,al as ve,I as y,a1 as P,y as x,Y as l,w as J,S as be,T as ge,J as h,M as u,P as a,$ as g,L as ye,X as K,Q as xe,R as Ne,aG as E,aj as k,a2 as ke,v as we}from"./index-DlZhamGx.js";import{_ as Ce,d as D}from"./RoleSelect.vue_vue_type_script_setup_true_lang-Jpq_OAnR.js";import{P as ee}from"./Page-DeLWWzfO.js";import{B as _e}from"./setting-bzqi1Zug.js";import{_ as De}from"./BaseDialog.vue_vue_type_script_setup_true_lang-PRE88zNh.js";const Pe={style:{float:"right"}},Ie=O({__name:"UserSelect",props:{placeholder:{type:String,default:"请选择"}},setup(f){const o=S({name:"",pageNumber:1,pageSize:10}),r=c(null),w=c(0),p=f;H(()=>{C()});const C=N=>s(null,null,function*(){N&&(o.name=N);const{data:v,total:d}=yield ve.getUserList(o);r.value=v,w.value=d});return(N,v)=>{const d=y("el-option"),_=y("el-select");return x(),P(_,{placeholder:p.placeholder,filterable:"",clearable:"","remote-method":C},{footer:l(()=>[u("div",Pe,[a(ee,{limit:o.pageSize,"onUpdate:limit":v[0]||(v[0]=i=>o.pageSize=i),page:o.pageNumber,"onUpdate:page":v[1]||(v[1]=i=>o.pageNumber=i),total:w.value,onPagination:C},null,8,["limit","page","total"])])]),default:l(()=>[(x(!0),J(be,null,ge(r.value,i=>(x(),J("div",null,[i.deptId?h("",!0):(x(),P(d,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))]))),256))]),_:1},8,["placeholder"])}}}),Ve={class:"flex-row"},he={class:"left-box"},Me={style:{"margin-bottom":"5px"}},Se={class:"organization_configuration"},Te={class:"custom-tree-node"},Be={style:{width:"calc(100% - 280px)"}},$e={class:"filter-container"},Ee={class:"dialog-footer"},Ue=O({name:"Department",__name:"Department",setup(f){const o=S({deptId:1,position:"",accountName:"",email:"",roleId:1,phoneNumber:"",work:1,accountId:""}),r=c([{accountId:"1001",accountName:"Zhang San",phoneNumber:"13800138001",email:"zhangsan@example.com",work:1,position:"Senior Engineer",roleName:"Technical Lead"},{accountId:"1002",accountName:"Li Si",phoneNumber:"13800138002",email:"lisi@example.com",work:1,position:"Software Engineer",roleName:"Developer"},{accountId:"1003",accountName:"Wang Wu",phoneNumber:"13800138003",email:"wangwu@example.com",work:0,position:"Frontend Engineer",roleName:"Developer"},{accountId:"1004",accountName:"Zhao Liu",phoneNumber:"13800138004",email:"zhaoliu@example.com",work:1,position:"Test Engineer",roleName:"Tester"},{accountId:"1005",accountName:"Qian Qi",phoneNumber:"13800138005",email:"qianqi@example.com",work:1,position:"Product Manager",roleName:"Product Staff"}]),w=c([{id:1,name:"xxxx Company",parentId:0,level:0,fullParentId:"0",fullParentName:null,children:[{id:4,name:"Frontend Development Department",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx Company",children:[]},{id:5,name:"Backend Development Department",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx Company",children:[{id:4,name:"Java Development Group",parentId:5,level:2,fullParentId:"0,1,5",fullParentName:"xxxx Company, Backend Development Department",children:[]},{id:6,name:"Python Development Group",parentId:5,level:2,fullParentId:"0,1,5",fullParentName:"xxxx Company, Backend Development Department",children:[]}]},{id:7,name:"Testing Department",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx Company",children:[]},{id:8,name:"Product Department",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx Company",children:[]}]}]),p=S({pageNumber:1,pageSize:10,deptId:null,accountName:null,email:null,phoneNumber:null,work:null}),C=c(0),N=c(null),v={children:"children",label:"name",id:"id"},d=c(!1),_=S({add:"Add Member",update:"Update Member Information"}),i=c(""),m=c(Q({},o)),te=S({accountName:[{required:!0,message:"Please enter name",trigger:"blur"}]}),U=c(),W=c(null),z=c(!1),$=S({x:0,y:0}),R=c(null);H(()=>{});const L=n=>s(null,null,function*(){var b;const{data:e}=yield D.getDepartmentList({});w.value=e,N.value=(b=w.value[0])==null?void 0:b.id,yield ke(()=>{W.value.setCurrentKey(N.value)}),yield M()}),A=n=>s(null,null,function*(){T(),E.prompt("Please enter department name","Add Department",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",inputPattern:/\S+/,inputErrorMessage:"Department name cannot be empty"}).then(b=>s(null,[b],function*({value:e}){yield D.addDepartment({name:e.trim(),parentId:n}),k({type:"success",message:`Successfully added department: ${e}`}),yield L()})).catch(()=>{k({type:"info",message:"Cancelled adding"})})}),ae=n=>s(null,null,function*(){T(),E.prompt("Please enter department name","Modify Department Name",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",inputValue:n.name,inputPattern:/\S+/,inputErrorMessage:"Department name cannot be empty"}).then(b=>s(null,[b],function*({value:e}){yield D.updateDepartment({id:n.id,name:e.trim()}),k({type:"success",message:`Successfully modified department: ${e}`}),yield L()})).catch(()=>{k({type:"info",message:"Cancelled modification"})})}),le=n=>s(null,null,function*(){T(),E.confirm("This operation will permanently delete the department. Continue?","Prompt",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>s(null,null,function*(){yield D.delDepartment({id:n}),k({type:"success",message:"Deleted successfully"}),yield L()})).catch(()=>{k({type:"info",message:"Cancelled deletion"})})}),ne=({id:n})=>{N.value=n,M()},M=()=>s(null,null,function*(){p.deptId=N.value;const{data:n,total:e}=yield D.getMemberList(p);r.value=n,C.value=e}),oe=n=>s(null,null,function*(){E.confirm("This operation will remove the department member to the top-level department. Continue?","Prompt",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>s(null,null,function*(){yield D.delDepartmentMember({accountId:n.accountId}),k({type:"success",message:"Removed successfully"}),yield M()})).catch(()=>{k({type:"info",message:"Cancelled removal"})})}),re=n=>s(null,null,function*(){n&&(yield n.validate(e=>s(null,null,function*(){e&&(i.value==="update"?yield D.updateDepartmentMember(m.value):yield D.addDepartmentMember(m.value),k({type:"success",message:_[i.value]+" successful!"}),F(),yield M())})))}),X=(n,e)=>{i.value=n,i.value==="update"&&(m.value=e),d.value=!0},F=()=>{d.value=!1,m.value=Q({},o),U.value.resetFields()},ie=(n,e,b)=>{n.preventDefault(),$.x=n.clientX,$.y=n.clientY,z.value=!0,R.value={data:e,node:b}},T=()=>{z.value=!1},q=n=>{if(!R.value)return;const{data:e}=R.value;switch(n){case"add":A(e.id);break;case"edit":ae(e);break;case"delete":le(e.id);break}T()};return(n,e)=>{const b=y("el-button"),me=y("el-link"),de=y("el-tree"),B=y("el-input"),I=y("el-table-column"),V=y("el-form-item"),Y=y("el-radio"),ue=y("el-radio-group"),se=y("el-form");return x(),J("div",{class:"app-container",onClick:T},[u("div",Ve,[u("div",he,[u("div",Me,[a(b,{type:"primary",size:"small",onClick:e[0]||(e[0]=t=>A(0))},{default:l(()=>[...e[17]||(e[17]=[g("Add Main Department",-1)])]),_:1})]),u("div",Se,[a(de,{ref_key:"treeDepartment",ref:W,style:{"max-width":"300px"},data:w.value,props:v,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,onNodeClick:ne,onNodeContextmenu:ie},{default:l(({node:t,data:G})=>[u("div",Te,[u("div",null,K(t.label),1),u("div",null,[a(me,{type:"primary",onClick:ze=>A(G.id)},{default:l(()=>[...e[18]||(e[18]=[g("Add",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["data"]),ye(u("div",{class:"context-menu",style:Ne({top:`${$.y}px`,left:`${$.x}px`})},[u("div",{class:"menu-item",onClick:e[1]||(e[1]=t=>q("add"))},"Add Node"),u("div",{class:"menu-item",onClick:e[2]||(e[2]=t=>q("edit"))},"Edit Node"),u("div",{class:"menu-item",onClick:e[3]||(e[3]=t=>q("delete"))},"Delete Node")],4),[[xe,z.value]])])]),u("div",Be,[u("div",$e,[a(B,{modelValue:p.accountName,"onUpdate:modelValue":e[4]||(e[4]=t=>p.accountName=t),class:"filter-item width",placeholder:"Please enter member name",clearable:""},null,8,["modelValue"]),a(b,{class:"filter-item",type:"primary",onClick:M},{default:l(()=>[...e[19]||(e[19]=[g("Search",-1)])]),_:1}),a(b,{class:"filter-item",type:"primary",onClick:e[5]||(e[5]=t=>X("add"))},{default:l(()=>[...e[20]||(e[20]=[g("Add Member",-1)])]),_:1})]),a(_e,{data:r.value,border:""},{default:l(()=>[a(I,{prop:"accountName",label:"Name",align:"center","min-width":"120"}),a(I,{prop:"phoneNumber",label:"Phone Number",align:"center","min-width":"150"}),a(I,{prop:"email",label:"Email",align:"center","min-width":"150"}),a(I,{prop:"work",label:"Employment Status",align:"center","min-width":"120"},{default:l(({row:t})=>[g(K((t==null?void 0:t.work)===1?"Employed":"Resigned"),1)]),_:1}),a(I,{prop:"position",label:"Position",align:"center","min-width":"120"}),a(I,{prop:"roleName",label:"Role",align:"center","min-width":"120"}),a(I,{label:"Actions",align:"center","min-width":"140",fixed:"right"},{default:l(({row:t})=>[a(b,{size:"small",type:"primary",onClick:G=>X("update",t)},{default:l(()=>[...e[21]||(e[21]=[g("Edit",-1)])]),_:1},8,["onClick"]),a(b,{size:"small",type:"danger",style:{"margin-left":"8px"},onClick:G=>oe(t)},{default:l(()=>[...e[22]||(e[22]=[g("Remove",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),a(ee,{limit:p.pageSize,"onUpdate:limit":e[6]||(e[6]=t=>p.pageSize=t),page:p.pageNumber,"onUpdate:page":e[7]||(e[7]=t=>p.pageNumber=t),total:C.value,onPagination:M},null,8,["limit","page","total"]),a(De,{modelValue:d.value,"onUpdate:modelValue":e[16]||(e[16]=t=>d.value=t),title:_[i.value],width:"500px",onClose:F},{footer:l(()=>[u("div",Ee,[a(b,{onClick:F},{default:l(()=>[...e[25]||(e[25]=[g("Cancel",-1)])]),_:1}),a(b,{type:"primary",onClick:e[15]||(e[15]=t=>re(U.value))},{default:l(()=>[...e[26]||(e[26]=[g("Confirm",-1)])]),_:1})])]),default:l(()=>[a(se,{ref_key:"memberFormRef",ref:U,model:m.value,"label-width":"auto","label-position":"right",rules:te},{default:l(()=>[i.value==="add"?(x(),P(V,{key:0,label:"Name",prop:"accountId",required:i.value==="add"},{default:l(()=>[a(Ie,{modelValue:m.value.accountId,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value.accountId=t),placeholder:"Please select member"},null,8,["modelValue"])]),_:1},8,["required"])):h("",!0),i.value==="update"?(x(),P(V,{key:1,label:"Name",prop:"accountName"},{default:l(()=>[a(B,{modelValue:m.value.accountName,"onUpdate:modelValue":e[9]||(e[9]=t=>m.value.accountName=t),placeholder:"Please enter name",clearable:""},null,8,["modelValue"])]),_:1})):h("",!0),i.value==="update"?(x(),P(V,{key:2,label:"Phone Number",prop:"phoneNumber"},{default:l(()=>[a(B,{modelValue:m.value.phoneNumber,"onUpdate:modelValue":e[10]||(e[10]=t=>m.value.phoneNumber=t),placeholder:"Please enter phone number",clearable:""},null,8,["modelValue"])]),_:1})):h("",!0),i.value==="update"?(x(),P(V,{key:3,label:"Email",prop:"email"},{default:l(()=>[a(B,{modelValue:m.value.email,"onUpdate:modelValue":e[11]||(e[11]=t=>m.value.email=t),placeholder:"Please enter email",clearable:""},null,8,["modelValue"])]),_:1})):h("",!0),i.value==="update"?(x(),P(V,{key:4,label:"Role",prop:"roleId"},{default:l(()=>[a(Ce,{modelValue:m.value.roleId,"onUpdate:modelValue":e[12]||(e[12]=t=>m.value.roleId=t)},null,8,["modelValue"])]),_:1})):h("",!0),a(V,{label:"Department Position",prop:"position"},{default:l(()=>[a(B,{modelValue:m.value.position,"onUpdate:modelValue":e[13]||(e[13]=t=>m.value.position=t),placeholder:"Please enter department position",clearable:""},null,8,["modelValue"])]),_:1}),i.value==="update"?(x(),P(V,{key:5,label:"Resignation Status",prop:"work"},{default:l(()=>[a(ue,{modelValue:m.value.work,"onUpdate:modelValue":e[14]||(e[14]=t=>m.value.work=t)},{default:l(()=>[a(Y,{value:0},{default:l(()=>[...e[23]||(e[23]=[g("Resigned",-1)])]),_:1}),a(Y,{value:1},{default:l(()=>[...e[24]||(e[24]=[g("Employed",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):h("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])])])}}}),Qe=we(Ue,[["__scopeId","data-v-9e066ba7"]]);export{Qe as default};
