var m=(f,u,i)=>new Promise((l,o)=>{var _=e=>{try{r(i.next(e))}catch(t){o(t)}},c=e=>{try{r(i.throw(e))}catch(t){o(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(_,c);r((i=i.apply(f,u)).next())});import{P as L}from"./Page-CtVCLxoG.js";import{B as S}from"./BaseTable-CN9KI-X5.js";import{D as U,r as g,o as C,R as d,a3 as k,z as v,X as p,y as N,T,U as M,ap as h,M as V,P as a,a2 as b,a1 as R,aK as x,an as w}from"./index-DofruHnK.js";import{_ as z}from"./DepartmentSelect.vue_vue_type_script_setup_true_lang-Dm9VVF2N.js";import{R as E}from"./setting-CF3FtGYT.js";import"./team-zXSTIE4G.js";const $=U({__name:"RoleSelect",props:{placeholder:{type:String,default:"请选择角色"}},setup(f){const u=f,i=g(null);C(()=>{l()});const l=()=>m(null,null,function*(){const{data:o}=yield E.getRoleList();i.value=o});return(o,_)=>{const c=d("el-option"),r=d("el-select");return v(),k(r,{placeholder:u.placeholder,clearable:""},{default:p(()=>[(v(!0),N(T,null,M(i.value,e=>(v(),k(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["placeholder"])}}}),A={class:"app-container"},D={class:"filter-container"},j={class:"flex justify-around"},O=U({__name:"UserList",setup(f){const u=g(null),i=g(0),l=g({account:null,name:null,deptId:null,roleId:null,phoneNumber:null,email:null,position:null,principal:null,pageSize:10,pageNumber:1});g(null),C(()=>{o()});function o(){return m(this,null,function*(){const{data:e,total:t}=yield h.getUserList(l.value);u.value=e,i.value=t})}function _(e){x.prompt("请确认是否重置密码，默认重置密码为“123456”，如需修改请重新输入","重置密码",{confirmButtonText:"确认",cancelButtonText:"取消",inputValue:"123456",inputType:"password",inputPattern:/\S+/,inputErrorMessage:"输入密码不能为空"}).then(B=>m(null,[B],function*({value:t}){yield h.resetPassword({resetAccountId:e.id,resetPassword:t.trim()}),w.success("重置密码成功!"),yield o()})).catch(()=>{w.info("已取消操作!")})}function c(e){x.confirm("是否删除该用户?","提示",{type:"warning"}).then(()=>m(null,null,function*(){yield h.deleteUser({id:e.id}),w.success("操作成功!"),yield o()})).catch(()=>{w.info("已取消操作!")})}const r=e=>{e?l.value.deptId=e[(e==null?void 0:e.length)-1]:l.value.deptId=e};return(e,t)=>{const B=d("el-input"),I=d("el-button"),s=d("el-table-column"),y=d("el-link");return v(),N("div",A,[V("div",D,[a(B,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=n=>l.value.name=n),placeholder:"请输入用户名",clearable:"",class:"filter-item width"},null,8,["modelValue"]),a($,{modelValue:l.value.roleId,"onUpdate:modelValue":t[1]||(t[1]=n=>l.value.roleId=n),class:"filter-item width"},null,8,["modelValue"]),a(z,{modelValue:l.value.deptId,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value.deptId=n),class:"filter-item width",onChange:r},null,8,["modelValue"]),a(I,{class:"filter-item",type:"primary",onClick:o},{default:p(()=>[...t[5]||(t[5]=[b("查询",-1)])]),_:1})]),a(S,{data:u.value},{default:p(()=>[a(s,{type:"index",label:"序号",align:"center",width:"60"}),a(s,{prop:"name",label:"用户名",align:"center","min-width":"120"}),a(s,{prop:"account",label:"账号",align:"center","min-width":"120"}),a(s,{prop:"deptName",label:"部门名称",align:"center","min-width":"120"}),a(s,{prop:"phoneNumber",label:"手机号码",align:"center","min-width":"150"}),a(s,{prop:"email",label:"邮箱",align:"center","min-width":"170"}),a(s,{prop:"roleName",label:"角色",align:"center","min-width":"120"}),a(s,{prop:"work",label:"在职状态",align:"center","min-width":"120"},{default:p(({row:n})=>[b(R((n==null?void 0:n.work)===1?"在职":"离职"),1)]),_:1}),a(s,{label:"操作",align:"center","min-width":"210",fixed:"right"},{default:p(({row:n})=>[V("div",j,[a(y,{type:"primary",onClick:P=>_(n)},{default:p(()=>[...t[6]||(t[6]=[b("重置密码",-1)])]),_:1},8,["onClick"]),a(y,{type:"danger",onClick:P=>c(n)},{default:p(()=>[...t[7]||(t[7]=[b("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]),a(L,{limit:l.value.pageSize,"onUpdate:limit":t[3]||(t[3]=n=>l.value.pageSize=n),page:l.value.pageNumber,"onUpdate:page":t[4]||(t[4]=n=>l.value.pageNumber=n),total:i.value,onPagination:o},null,8,["limit","page","total"])])}}});export{O as default};
