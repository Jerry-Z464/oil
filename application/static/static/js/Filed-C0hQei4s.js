var w=(c,d,f)=>new Promise((h,F)=>{var m=n=>{try{b(f.next(n))}catch(V){F(V)}},o=n=>{try{b(f.throw(n))}catch(V){F(V)}},b=n=>n.done?h(n.value):Promise.resolve(n.value).then(m,o);b((f=f.apply(c,d)).next())});import{aI as S,D as q,k as D,r as C,$ as p,o as E,R as g,y as I,z as R,M as $,P as l,q as a,t as e,X as i,a2 as k,a1 as v,aJ as W,W as O,aK as j,an as P}from"./index-DofruHnK.js";import{_ as A}from"./BaseDialog.vue_vue_type_script_setup_true_lang-1kYJ3j0E.js";import{P as J}from"./Page-CtVCLxoG.js";const x={updateFieldStatus:c=>S.postWithForm("config/field/switch",{data:c}),updateFieldDefault:c=>S.postWithForm("config/field/update",{data:c}),getFieldList:c=>S.get("config/list",{params:c})},K={class:"app-container"},X={class:"filter-container"},Z=q({__name:"Filed",setup(c){const d=D({pageNumber:1,pageSize:20,field_name:null}),f=C([]),h=C(null),F=D({default_value:[{required:!0,message:p("field.defaultValuePlaceholder"),trigger:"blur"}]}),m=C(!1),o=C(null),b=C(0);E(()=>{n()});const n=()=>w(null,null,function*(){const{data:u,total:t}=yield x.getFieldList(d);f.value=u,b.value=t}),V=u=>{const t=u.status===1?0:1,_=u.status===1?e("status.disable"):e("status.enable");j.confirm(`${p("field.confirmIfNot")+_+p("field.field")}`,p("message.tip"),{type:"warning"}).then(()=>w(null,null,function*(){yield x.updateFieldStatus({id:u.id,status:t}),P.success(`${_+p("status.success")}`),yield n()})).catch(()=>{P.info(p("message.cancelOperation"))})},U=u=>{const t=Object.assign({},u);o.value={id:t.id,unit:t.unit,default_value:t.default_value},m.value=!0},L=()=>w(null,null,function*(){h.value&&(yield h.value.validate(u=>w(null,null,function*(){u&&(yield x.updateFieldDefault(o.value),P.success(p("message.submitSuccess")),yield n(),N())})))}),N=()=>{m.value=!1,o.value={}};return(u,t)=>{const _=g("el-input"),y=g("el-button"),r=g("el-table-column"),B=g("el-table"),z=g("el-form-item"),M=g("el-form");return R(),I("div",K,[$("div",X,[l(_,{modelValue:d.field_name,"onUpdate:modelValue":t[0]||(t[0]=s=>d.field_name=s),placeholder:a(e)("field.fieldNamePlaceholder"),class:"filter-item width",clearable:""},null,8,["modelValue","placeholder"]),l(y,{class:"filter-item",type:"primary",icon:a(W),onClick:n},{default:i(()=>[k(v(a(e)("buttons.search")),1)]),_:1},8,["icon"])]),l(B,{data:f.value,border:""},{default:i(()=>[l(r,{type:"index",label:a(e)("table.serialNumber"),width:"70",align:"center"},null,8,["label"]),l(r,{prop:"field_name",label:a(e)("field.fieldName"),"min-width":"140",align:"center"},null,8,["label"]),l(r,{prop:"description",label:a(e)("field.description"),"min-width":"180",align:"center"},null,8,["label"]),l(r,{prop:"data_type",label:a(e)("field.dataType"),"min-width":"120",align:"center"},null,8,["label"]),l(r,{prop:"default_value",label:a(e)("field.defaultValue"),"min-width":"120",align:"center"},null,8,["label"]),l(r,{prop:"unit",label:a(e)("field.unit"),"min-width":"100",align:"center"},null,8,["label"]),l(r,{prop:"storage_format",label:a(e)("field.storageFormat"),"min-width":"150",align:"center"},null,8,["label"]),l(r,{prop:"status",label:a(e)("field.status"),"min-width":"100",align:"center"},{default:i(({row:s})=>[$("span",{class:O(["status-badge",s.status===1?"status-active":"status-inactive"])},v(s.status===1?a(e)("status.enable"):a(e)("status.disable")),3)]),_:1},8,["label"]),l(r,{label:a(e)("table.operation"),"min-width":"180",align:"center",fixed:"right"},{default:i(({row:s})=>[l(y,{size:"small",type:"primary",onClick:T=>U(s)},{default:i(()=>[k(v(a(e)("field.configureDefaultValue")),1)]),_:1},8,["onClick"]),l(y,{size:"small",type:s.status===1?"danger":"success",onClick:T=>V(s)},{default:i(()=>[k(v(s.status===1?a(e)("status.disable"):a(e)("status.enable")),1)]),_:2},1032,["type","onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),l(J,{limit:d.pageSize,"onUpdate:limit":t[1]||(t[1]=s=>d.pageSize=s),page:d.pageNumber,"onUpdate:page":t[2]||(t[2]=s=>d.pageNumber=s),total:b.value,onPagination:n},null,8,["limit","page","total"]),l(A,{title:"配置默认值",modelValue:m.value,"onUpdate:modelValue":t[5]||(t[5]=s=>m.value=s),onClose:N},{footer:i(()=>[l(y,{onClick:N},{default:i(()=>[k(v(a(e)("buttons.cancel")),1)]),_:1}),l(y,{type:"primary",onClick:L},{default:i(()=>[k(v(a(e)("buttons.pureConfirm")),1)]),_:1})]),default:i(()=>[l(M,{ref_key:"formRef",ref:h,model:o.value,"label-width":"auto",rules:F},{default:i(()=>[l(z,{label:a(e)("field.unit"),prop:"unit"},{default:i(()=>[l(_,{modelValue:o.value.unit,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.unit=s),placeholder:a(e)("field.unitPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(z,{label:a(e)("field.defaultValue"),prop:"default_value"},{default:i(()=>[l(_,{modelValue:o.value.default_value,"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.default_value=s),placeholder:a(e)("field.defaultValuePlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Z as default};
