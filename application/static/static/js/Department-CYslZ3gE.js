var se=Object.defineProperty;var j=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var G=(v,i,d)=>i in v?se(v,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):v[i]=d,K=(v,i)=>{for(var d in i||(i={}))ie.call(i,d)&&G(v,d,i[d]);if(j)for(var d of j(i))pe.call(i,d)&&G(v,d,i[d]);return v};var u=(v,i,d)=>new Promise(($,h)=>{var x=w=>{try{g(d.next(w))}catch(N){h(N)}},B=w=>{try{g(d.throw(w))}catch(N){h(N)}},g=w=>w.done?$(w.value):Promise.resolve(w.value).then(x,B);g((d=d.apply(v,i)).next())});import{D as ue,k as E,r as f,t as e,o as ce,a4 as fe,ap as H,R as y,y as be,z as ve,M as p,P as a,X as o,a2 as b,a1 as c,q as n,L as xe,Q as ge,S as we,aK as z,an as _,w as ye}from"./index-DofruHnK.js";import{d as I}from"./team-zXSTIE4G.js";import{P as _e}from"./Page-CtVCLxoG.js";import{B as Ne}from"./BaseTable-CN9KI-X5.js";import{_ as he}from"./BaseDialog.vue_vue_type_script_setup_true_lang-1kYJ3j0E.js";const Ce={class:"flex-row"},ke={class:"left-box"},Pe={style:{"margin-bottom":"5px"}},Ie={class:"organization_configuration"},Ve={class:"custom-tree-node"},Me={style:{width:"calc(100% - 280px)"}},De={class:"filter-container"},Ee={class:"dialog-footer"},$e=ue({name:"Department",__name:"Department",setup(v){const i={0:"admin",1:"editor",2:"viewer"},d=E({deptId:1,name:"",email:"",role:1,phoneNumber:"",password:null,confirmPassword:null}),$=f([{accountId:"1001",name:"张三",phoneNumber:"13800138001",email:"zhangsan@example.com",work:1,position:"高级工程师",roleName:"技术主管"},{accountId:"1002",name:"李四",phoneNumber:"13800138002",email:"lisi@example.com",work:1,position:"软件工程师",roleName:"开发人员"},{accountId:"1003",name:"王五",phoneNumber:"13800138003",email:"wangwu@example.com",work:0,position:"前端工程师",roleName:"开发人员"},{accountId:"1004",name:"赵六",phoneNumber:"13800138004",email:"zhaoliu@example.com",work:1,position:"测试工程师",roleName:"测试人员"},{accountId:"1005",name:"钱七",phoneNumber:"13800138005",email:"qianqi@example.com",work:1,position:"产品经理",roleName:"产品人员"}]),h=f([{id:1,name:"xxxx公司",parentId:0,level:0,fullParentId:"0",fullParentName:null,children:[{id:4,name:"前端开发部",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx公司",children:[]},{id:5,name:"后端开发部",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx公司",children:[{id:4,name:"Java开发组",parentId:5,level:2,fullParentId:"0,1,5",fullParentName:"xxxx公司,后端开发部",children:[]},{id:6,name:"Python开发组",parentId:5,level:2,fullParentId:"0,1,5",fullParentName:"xxxx公司,后端开发部",children:[]}]},{id:7,name:"测试部",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx公司",children:[]},{id:8,name:"产品部",parentId:1,level:1,fullParentId:"0,1",fullParentName:"xxxx公司",children:[]}]}]),x=E({pageNumber:1,pageSize:10,deptId:null,name:null,email:null,phoneNumber:null}),B=f(0),g=f(null),w={children:"children",label:"name",id:"id"},N=f(!1),X=E({add:e("department.addMember"),update:e("department.updateMemberInfo")}),V=f(""),m=f(K({},d)),W=E({name:[{required:!0,message:e("department.pleaseEnterName"),trigger:"blur"}],password:[{required:!0,message:e("department.pleaseEnterPassword"),trigger:"blur"}],confirmPassword:[{required:!0,message:e("department.pleaseEnterConfirmPassword"),trigger:"blur"},{validator:(r,t,s)=>{t!==m.value.password?s(new Error(e("department.passwordNotMatch"))):s()},trigger:"blur"}]}),U=f(),J=f(null),q=f(!1),S=E({x:0,y:0}),F=f(null);ce(()=>{T()});const T=r=>u(null,null,function*(){var s;const{data:t}=yield I.getDepartmentList({});h.value=t,g.value=(s=h.value[0])==null?void 0:s.id,yield fe(()=>{J.value.setCurrentKey(g.value)}),yield C()}),R=r=>u(null,null,function*(){M(),z.prompt(e("department.departmentName"),e("department.addDepartment"),{confirmButtonText:e("buttons.pureConfirm"),cancelButtonText:e("buttons.cancel"),inputPattern:/\S+/,inputErrorMessage:e("department.inputDepartmentCannotEmpty")}).then(s=>u(null,[s],function*({value:t}){yield I.addDepartment({name:t.trim(),parentId:r}),_({type:"success",message:`${e("department.successAddDepartment")}：${t}`}),yield T()})).catch(()=>{_({type:"info",message:e("department.cancelOperation")})})}),Z=r=>u(null,null,function*(){M(),z.prompt(e("department.departmentName"),e("department.modifyDepartmentName"),{confirmButtonText:e("buttons.pureConfirm"),cancelButtonText:e("buttons.cancel"),inputValue:r.name,inputPattern:/\S+/,inputErrorMessage:e("department.inputDepartmentCannotEmpty")}).then(s=>u(null,[s],function*({value:t}){yield I.updateDepartment({id:r.id,name:t.trim()}),_({type:"success",message:`${e("department.successModifyDepartment")}${t}`}),yield T()})).catch(()=>{_({type:"info",message:e("department.cancelOperation")})})}),ee=r=>u(null,null,function*(){M(),z.confirm(e("department.deleteDepartmentConfirm"),e("message.tip"),{confirmButtonText:e("buttons.pureConfirm"),cancelButtonText:e("buttons.cancel"),type:"warning"}).then(()=>u(null,null,function*(){yield I.delDepartment({id:r}),_({type:"success",message:e("department.deleteSuccess")}),yield T()})).catch(()=>{_({type:"info",message:e("department.cancelOperation")})})}),te=({id:r})=>{g.value=r,C()},C=()=>u(null,null,function*(){x.deptId=g.value;const{data:r,total:t}=yield H.getUserList(x);$.value=r,B.value=t}),ae=r=>u(null,null,function*(){z.confirm(e("department.deleteMemberConfirm"),e("message.tip"),{confirmButtonText:e("buttons.pureConfirm"),cancelButtonText:e("buttons.cancel"),type:"warning"}).then(()=>u(null,null,function*(){yield I.delDepartmentMember({accountId:r.accountId}),_({type:"success",message:e("department.removeSuccess")}),yield C()})).catch(()=>{_({type:"info",message:e("department.cancelOperation")})})}),le=r=>u(null,null,function*(){r&&(yield r.validate(t=>u(null,null,function*(){t&&(m.value.deptId=g.value,V.value==="update"?yield I.updateDepartmentMember(m.value):yield H.register(m.value),_({type:"success",message:X[V.value]+e("status.success")+"！"}),O(),yield C())})))}),Q=(r,t)=>{V.value=r,V.value==="update"&&(m.value=t),N.value=!0},O=()=>{N.value=!1,m.value=K({},d),U.value.resetFields()},ne=(r,t,s)=>{r.preventDefault(),S.x=r.clientX,S.y=r.clientY,q.value=!0,F.value={data:t,node:s}},M=()=>{q.value=!1},L=r=>{if(!F.value)return;const{data:t}=F.value;switch(r){case"add":R(t.id);break;case"edit":Z(t);break;case"delete":ee(t.id);break}M()};return(r,t)=>{const s=y("el-button"),re=y("el-link"),oe=y("el-tree"),k=y("el-input"),D=y("el-table-column"),P=y("el-form-item"),Y=y("el-radio"),me=y("el-radio-group"),de=y("el-form");return ve(),be("div",{class:"app-container",onClick:M},[p("div",Ce,[p("div",ke,[p("div",Pe,[a(s,{type:"primary",size:"small",onClick:t[0]||(t[0]=l=>R(0))},{default:o(()=>[b(c(n(e)("department.addMainDepartment")),1)]),_:1})]),p("div",Ie,[a(oe,{ref_key:"treeDepartment",ref:J,style:{"max-width":"300px"},data:h.value,props:w,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,onNodeClick:te,onNodeContextmenu:ne},{default:o(({node:l,data:A})=>[p("div",Ve,[p("div",null,c(l.label),1),p("div",null,[a(re,{type:"primary",onClick:Be=>R(A.id)},{default:o(()=>[b(c(n(e)("buttons.add")),1)]),_:1},8,["onClick"])])])]),_:1},8,["data"]),xe(p("div",{class:"context-menu",style:we({top:`${S.y}px`,left:`${S.x}px`})},[p("div",{class:"menu-item",onClick:t[1]||(t[1]=l=>L("add"))},c(n(e)("department.addNode")),1),p("div",{class:"menu-item",onClick:t[2]||(t[2]=l=>L("edit"))},c(n(e)("department.editNode")),1),p("div",{class:"menu-item",onClick:t[3]||(t[3]=l=>L("delete"))},c(n(e)("department.deleteNode")),1)],4),[[ge,q.value]])])]),p("div",Me,[p("div",De,[a(k,{modelValue:x.name,"onUpdate:modelValue":t[4]||(t[4]=l=>x.name=l),class:"filter-item w300",placeholder:n(e)("department.departmentName"),clearable:""},null,8,["modelValue","placeholder"]),a(s,{class:"filter-item",type:"primary",onClick:C},{default:o(()=>[b(c(n(e)("buttons.search")),1)]),_:1}),a(s,{class:"filter-item",type:"primary",onClick:t[5]||(t[5]=l=>Q("add"))},{default:o(()=>[b(c(n(e)("department.addMember")),1)]),_:1})]),a(Ne,{data:$.value,border:""},{default:o(()=>[a(D,{prop:"name",label:n(e)("department.name"),align:"center","min-width":"120"},null,8,["label"]),a(D,{prop:"phoneNumber",label:n(e)("department.phoneNumber"),align:"center","min-width":"150"},null,8,["label"]),a(D,{prop:"email",label:n(e)("department.email"),align:"center","min-width":"150"},null,8,["label"]),a(D,{prop:"role",label:n(e)("department.role"),align:"center","min-width":"120"},{default:o(({row:l})=>[b(c(i[l.role]),1)]),_:1},8,["label"]),a(D,{label:n(e)("table.operation"),align:"center","min-width":"140",fixed:"right"},{default:o(({row:l})=>[a(s,{size:"small",type:"primary",onClick:A=>Q("update",l)},{default:o(()=>[b(c(n(e)("buttons.modify")),1)]),_:1},8,["onClick"]),a(s,{size:"small",type:"danger",style:{"margin-left":"8px"},onClick:A=>ae(l)},{default:o(()=>[b(c(n(e)("buttons.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"]),a(_e,{limit:x.pageSize,"onUpdate:limit":t[6]||(t[6]=l=>x.pageSize=l),page:x.pageNumber,"onUpdate:page":t[7]||(t[7]=l=>x.pageNumber=l),total:B.value,onPagination:C},null,8,["limit","page","total"]),a(he,{modelValue:N.value,"onUpdate:modelValue":t[15]||(t[15]=l=>N.value=l),title:X[V.value],width:"500px",onClose:O},{footer:o(()=>[p("div",Ee,[a(s,{onClick:O},{default:o(()=>[b(c(n(e)("buttons.cancel")),1)]),_:1}),a(s,{type:"primary",onClick:t[14]||(t[14]=l=>le(U.value))},{default:o(()=>[b(c(n(e)("buttons.pureConfirm")),1)]),_:1})])]),default:o(()=>[a(de,{ref_key:"memberFormRef",ref:U,model:m.value,"label-width":"auto","label-position":"right",rules:W},{default:o(()=>[a(P,{label:n(e)("department.name"),prop:"name"},{default:o(()=>[a(k,{modelValue:m.value.name,"onUpdate:modelValue":t[8]||(t[8]=l=>m.value.name=l),placeholder:n(e)("department.pleaseEnterName"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(P,{label:n(e)("department.password"),prop:"password"},{default:o(()=>[a(k,{modelValue:m.value.password,"onUpdate:modelValue":t[9]||(t[9]=l=>m.value.password=l),placeholder:n(e)("department.pleaseEnterPassword"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(P,{label:n(e)("department.confirmPassword"),prop:"confirmPassword"},{default:o(()=>[a(k,{modelValue:m.value.confirmPassword,"onUpdate:modelValue":t[10]||(t[10]=l=>m.value.confirmPassword=l),placeholder:n(e)("department.pleaseEnterPassword"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(P,{label:n(e)("department.phoneNumber"),prop:"phoneNumber"},{default:o(()=>[a(k,{modelValue:m.value.phoneNumber,"onUpdate:modelValue":t[11]||(t[11]=l=>m.value.phoneNumber=l),placeholder:n(e)("department.pleaseEnterPhoneNumber"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(P,{label:n(e)("department.email"),prop:"email"},{default:o(()=>[a(k,{modelValue:m.value.email,"onUpdate:modelValue":t[12]||(t[12]=l=>m.value.email=l),placeholder:n(e)("department.pleaseEnterEmail"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(P,{label:n(e)("department.role"),prop:"role"},{default:o(()=>[a(me,{modelValue:m.value.role,"onUpdate:modelValue":t[13]||(t[13]=l=>m.value.role=l)},{default:o(()=>[a(Y,{value:1},{default:o(()=>[...t[16]||(t[16]=[b("editor",-1)])]),_:1}),a(Y,{value:2},{default:o(()=>[...t[17]||(t[17]=[b("viewer",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])])])}}}),Re=ye($e,[["__scopeId","data-v-8662311b"]]);export{Re as default};
