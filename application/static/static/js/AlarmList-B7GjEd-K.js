import{A as G,b as d,k as H,o as K,I as u,w as S,y as _,M as b,P as l,Y as t,$ as n,V as L,X as c,J as Q,a1 as N,S as Z,T as ee,aj as w,v as le}from"./index-DlZhamGx.js";const te={class:"dashboard-container"},ae={class:"header"},ie={class:"dialog-footer"},se={key:0,class:"alert-detail"},ne={key:0},oe={key:1},re={class:"suppression-desc"},ue={class:"dialog-footer"},de=G({__name:"AlarmList",setup(me){d(!0),d(!0);const B=d(30),m=d([]),V=d([]),D=d(!1),k=d(!1);d("email");const r=d(null),s=d({level:"warning",deviceId:"Device-A-001",metric:"Pressure",currentValue:"520",threshold:"500",channels:["email","sms"]}),P=i=>new Date(i).toLocaleString("en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/\//g,"-"),M=i=>({critical:"Critical",warning:"Warning",info:"Info"})[i]||i,W=i=>{r.value=i,D.value=!0},C=d(!1),z=()=>{w.info("Use the test panel below to send test notifications"),C.value=!0},q=()=>{k.value=!0},F=()=>{const i={id:Date.now(),timestamp:Date.now(),level:s.value.level,title:`Test Alert - ${s.value.deviceId}`,message:`Device ${s.value.deviceId} ${s.value.metric} metric abnormal`,deviceId:s.value.deviceId,metric:s.value.metric,currentValue:s.value.currentValue,threshold:s.value.threshold,channels:s.value.channels,notified:!0,suppressed:!1};U(i)?(i.suppressed=!0,i.notified=!1,w.warning("Test alert has been suppressed (duplicate alert)")):w.success("Test notification sent successfully"),V.value.unshift(i),m.value.unshift(i),m.value.length>10&&(m.value=m.value.slice(0,10)),C.value=!1},U=i=>{const e=Date.now(),o=B.value*60*1e3;return V.value.filter(y=>y.deviceId===i.deviceId&&y.metric===i.metric&&e-y.timestamp<o).length>0},j=()=>{const i=V.value.filter(e=>e.suppressed);i.length===0?w.info("No suppressed alerts today"):w.info(`Total ${i.length} alerts suppressed today`)},J=()=>{const i=[{level:"critical",deviceId:"Device-A-001",metric:"Differential Pressure",threshold:"500 kPa",suggestion:"Immediately check transmitter status, confirm if equipment is normal"},{level:"warning",deviceId:"Device-B-002",metric:"Temperature",threshold:"85째C",suggestion:"Check cooling system, confirm temperature sensor working properly"},{level:"warning",deviceId:"Device-C-003",metric:"Data Flow",threshold:"5 minutes",suggestion:"Check network connection and device communication status"}];setInterval(()=>{if(Math.random()>.7){const e=i[Math.floor(Math.random()*i.length)],o={id:Date.now(),timestamp:Date.now(),level:e.level,title:`${e.level==="critical"?"Critical":"Warning"} Alert - ${e.deviceId}`,message:`Device ${e.deviceId} ${e.metric} exceeded threshold`,deviceId:e.deviceId,metric:e.metric,currentValue:e.level==="critical"?"512 kPa":"87.5째C",threshold:e.threshold,suggestion:e.suggestion,channels:["email","sms"],notified:!0,suppressed:!1};U(o)?(o.suppressed=!0,o.notified=!1,V.value.unshift(o)):(V.value.unshift(o),m.value.unshift(o),m.value.length>10&&(m.value=m.value.slice(0,10)))}},3e4)},g=H({channels:["email"],suppressionWindow:30,recipients:[]}),O=()=>{w.success("Notification settings saved"),k.value=!1};return K(()=>{const i=[{id:1,timestamp:Date.now()-3e5,level:"warning",title:"Warning Alert - Device-A-001",message:"Device Device-A-001 pressure exceeded threshold",deviceId:"Device-A-001",metric:"Pressure",currentValue:"520 kPa",threshold:"500 kPa",channels:["email"],notified:!0,suppressed:!1,suggestion:"Immediately check transmitter status, confirm if equipment is normal"},{id:2,timestamp:Date.now()-6e5,level:"critical",title:"Critical Alert - Device-B-002",message:"Device Device-B-002 temperature abnormal",deviceId:"Device-B-002",metric:"Temperature",currentValue:"89.2째C",threshold:"85째C",channels:["email","sms"],notified:!0,suppressed:!1,suggestion:"Check cooling system, confirm temperature sensor working properly"}];V.value=i,m.value=i,J()}),(i,e)=>{const o=u("el-button"),p=u("el-table-column"),y=u("el-table"),h=u("el-option"),A=u("el-select"),v=u("el-form-item"),I=u("el-input"),$=u("el-form"),x=u("el-dialog"),f=u("el-descriptions-item"),T=u("el-tag"),R=u("el-descriptions"),E=u("el-checkbox"),X=u("el-checkbox-group"),Y=u("el-slider");return _(),S("div",te,[b("div",ae,[b("div",null,[l(o,{type:"primary",size:"small",onClick:z},{default:t(()=>[...e[16]||(e[16]=[n("Test Notification",-1)])]),_:1}),l(o,{size:"small",onClick:q},{default:t(()=>[...e[17]||(e[17]=[n("Notification Settings",-1)])]),_:1}),l(o,{size:"small",onClick:j},{default:t(()=>[...e[18]||(e[18]=[n("View Suppression Log",-1)])]),_:1})])]),l(y,{data:m.value,border:""},{default:t(()=>[l(p,{type:"index",label:"No.",width:"80",align:"center"}),l(p,{prop:"level",label:"Alert Level","min-width":"120",align:"center"},{default:t(a=>[b("span",{class:L(["alert-level","level-"+a.row.level])},c(M(a.row.level)),3)]),_:1}),l(p,{prop:"deviceId",label:"Device ID","min-width":"150",align:"center"}),l(p,{prop:"metric",label:"Metric","min-width":"120",align:"center"}),l(p,{prop:"currentValue",label:"Current Value","min-width":"120",align:"center"}),l(p,{prop:"threshold",label:"Threshold","min-width":"120",align:"center"}),l(p,{prop:"suggestion",label:"Suggestion",align:"center","min-width":"220"}),l(p,{label:"Operations",align:"center"},{default:t(a=>[l(o,{size:"small",type:"primary",onClick:ce=>W(a.row)},{default:t(()=>[...e[19]||(e[19]=[n("Details",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l(x,{modelValue:C.value,"onUpdate:modelValue":e[7]||(e[7]=a=>C.value=a),title:"Send Test Notification",width:"600px"},{footer:t(()=>[b("span",ie,[l(o,{onClick:e[6]||(e[6]=a=>C.value=!1)},{default:t(()=>[...e[20]||(e[20]=[n("Cancel",-1)])]),_:1}),l(o,{type:"primary",onClick:F},{default:t(()=>[...e[21]||(e[21]=[n("Send Test Notification",-1)])]),_:1})])]),default:t(()=>[l($,{model:s.value,"label-width":"100px"},{default:t(()=>[l(v,{label:"Alert Level"},{default:t(()=>[l(A,{modelValue:s.value.level,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.level=a),placeholder:"Select alert level",style:{width:"100%"}},{default:t(()=>[l(h,{label:"Critical",value:"critical"}),l(h,{label:"Warning",value:"warning"}),l(h,{label:"Info",value:"info"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"Device ID"},{default:t(()=>[l(I,{modelValue:s.value.deviceId,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.deviceId=a),placeholder:"Enter device ID"},null,8,["modelValue"])]),_:1}),l(v,{label:"Metric"},{default:t(()=>[l(I,{modelValue:s.value.metric,"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.metric=a),placeholder:"Enter monitoring metric"},null,8,["modelValue"])]),_:1}),l(v,{label:"Current Value"},{default:t(()=>[l(I,{modelValue:s.value.currentValue,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.currentValue=a),placeholder:"Enter current value"},null,8,["modelValue"])]),_:1}),l(v,{label:"Threshold"},{default:t(()=>[l(I,{modelValue:s.value.threshold,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.threshold=a),placeholder:"Enter threshold"},null,8,["modelValue"])]),_:1}),l(v,{label:"Notification Channels"},{default:t(()=>[l(A,{modelValue:s.value.channels,"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.channels=a),multiple:"",placeholder:"Select notification channels",style:{width:"100%"}},{default:t(()=>[l(h,{label:"Email",value:"email"}),l(h,{label:"SMS",value:"sms"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(x,{modelValue:D.value,"onUpdate:modelValue":e[10]||(e[10]=a=>D.value=a),title:r.value?r.value.title:"Alert Details",width:"600px"},{footer:t(()=>[l(o,{onClick:e[8]||(e[8]=a=>D.value=!1)},{default:t(()=>[...e[24]||(e[24]=[n("Close",-1)])]),_:1}),l(o,{type:"primary",onClick:e[9]||(e[9]=a=>D.value=!1)},{default:t(()=>[...e[25]||(e[25]=[n("Confirm",-1)])]),_:1})]),default:t(()=>[r.value?(_(),S("div",se,[l(R,{column:2,border:""},{default:t(()=>[l(f,{label:"Alert Level"},{default:t(()=>[b("span",{class:L(["alert-level","level-"+r.value.level])},c(M(r.value.level)),3)]),_:1}),l(f,{label:"Trigger Time"},{default:t(()=>[n(c(P(r.value.timestamp)),1)]),_:1}),l(f,{label:"Device ID"},{default:t(()=>[n(c(r.value.deviceId),1)]),_:1}),l(f,{label:"Metric"},{default:t(()=>[n(c(r.value.metric),1)]),_:1}),l(f,{label:"Current Value"},{default:t(()=>[n(c(r.value.currentValue),1)]),_:1}),l(f,{label:"Threshold"},{default:t(()=>[n(c(r.value.threshold),1)]),_:1}),l(f,{label:"Notification Status",span:2},{default:t(()=>[r.value.notified?(_(),N(T,{key:0,type:"success"},{default:t(()=>[...e[22]||(e[22]=[n("Notified",-1)])]),_:1})):(_(),N(T,{key:1,type:"info"},{default:t(()=>[...e[23]||(e[23]=[n("Not Notified",-1)])]),_:1}))]),_:1}),l(f,{label:"Notification Channels",span:2},{default:t(()=>[r.value.channels&&r.value.channels.length>0?(_(),S("div",ne,[(_(!0),S(Z,null,ee(r.value.channels,a=>(_(),N(T,{key:a,style:{"margin-right":"5px"}},{default:t(()=>[n(c(a==="email"?"Email":"SMS"),1)]),_:2},1024))),128))])):(_(),S("span",oe,"Not Configured"))]),_:1}),l(f,{label:"Suggestion",span:2},{default:t(()=>[n(c(r.value.suggestion||"Please check device status and related parameter configuration"),1)]),_:1})]),_:1})])):Q("",!0)]),_:1},8,["modelValue","title"]),l(x,{modelValue:k.value,"onUpdate:modelValue":e[15]||(e[15]=a=>k.value=a),title:"Notification Settings",width:"600px"},{footer:t(()=>[b("span",ue,[l(o,{onClick:e[14]||(e[14]=a=>k.value=!1)},{default:t(()=>[...e[28]||(e[28]=[n("Cancel",-1)])]),_:1}),l(o,{type:"primary",onClick:O},{default:t(()=>[...e[29]||(e[29]=[n("Save Settings",-1)])]),_:1})])]),default:t(()=>[l($,{model:g,"label-width":"auto"},{default:t(()=>[l(v,{label:"Notification Methods"},{default:t(()=>[l(X,{modelValue:g.channels,"onUpdate:modelValue":e[11]||(e[11]=a=>g.channels=a)},{default:t(()=>[l(E,{label:"email"},{default:t(()=>[...e[26]||(e[26]=[n("Email",-1)])]),_:1}),l(E,{label:"sms"},{default:t(()=>[...e[27]||(e[27]=[n("SMS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"Alert Suppression Time"},{default:t(()=>[l(Y,{modelValue:g.suppressionWindow,"onUpdate:modelValue":e[12]||(e[12]=a=>g.suppressionWindow=a),min:5,max:120,step:5,"show-input":"","show-input-controls":"","input-size":"small"},null,8,["modelValue"]),b("div",re,"Similar alerts will not be resent within "+c(g.suppressionWindow)+" minutes",1)]),_:1}),l(v,{label:"Recipients"},{default:t(()=>[l(A,{modelValue:g.recipients,"onUpdate:modelValue":e[13]||(e[13]=a=>g.recipients=a),multiple:"",placeholder:"Select recipients",style:{width:"100%"}},{default:t(()=>[l(h,{label:"Admin (admin@example.com)",value:"admin@example.com"}),l(h,{label:"Engineer A (engineer.a@example.com)",value:"engineer.a@example.com"}),l(h,{label:"Engineer B (engineer.b@example.com)",value:"engineer.b@example.com"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ve=le(de,[["__scopeId","data-v-d43c1824"]]);export{ve as default};
