var de=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var G=(f,o,u)=>o in f?de(f,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):f[o]=u,R=(f,o)=>{for(var u in o||(o={}))re.call(o,u)&&G(f,u,o[u]);if(Y)for(var u of Y(o))se.call(o,u)&&G(f,u,o[u]);return f};var b=(f,o,u)=>new Promise((_,w)=>{var s=r=>{try{g(u.next(r))}catch(B){w(B)}},$=r=>{try{g(u.throw(r))}catch(B){w(B)}},g=r=>r.done?_(r.value):Promise.resolve(r.value).then(s,$);g((u=u.apply(f,o)).next())});import{_ as H}from"./BaseDialog.vue_vue_type_script_setup_true_lang-1kYJ3j0E.js";import{b as y}from"./setting-CF3FtGYT.js";import{B as pe}from"./BaseTable-CN9KI-X5.js";import{P as me}from"./Page-CtVCLxoG.js";import{D as fe,r as d,k as T,o as ve,R as v,y as J,z,M as E,P as l,X as a,a2 as m,T as ce,U as ye,a3 as ge,a1 as be,aK as Q,an as S}from"./index-DofruHnK.js";const Ce={class:"app-container"},Ve={class:"filter-container"},ke=["onDblclick"],Te={class:"filter-container"},xe=fe({__name:"BaseType",setup(f){const o=d(!1),u=T({add:"添加类型",update:"修改类型"}),_=d(null),w=T({id:null,type:null,code:null}),s=d(R({},w)),$=T({type:[{required:!0,message:"请输入类型名称",trigger:"blur"}],code:[{required:!0,message:"请输入类型编码",trigger:"blur"},{pattern:/^[A-Z]+(_[A-Z]+)*$/,message:"编码必须为全大写英文和下划线组合",trigger:"blur"}]}),g=d(),r=d(!1),B=T({add:"添加类型内容",update:"修改类型内容"}),D=d(null),P=T({typeCode:null,content:null,rank:1,code:null}),i=d(R({},P)),W=T({content:[{required:!0,message:"请输入类型内容",trigger:"blur"}],code:[{required:!0,message:"请输入类型内容编码",trigger:"blur"}],rank:[{required:!0,message:"请输入排序",trigger:"blur"}]}),L=d(),x=d("condition"),C=d([{id:1,type:"条件类型",code:"condition"}]),O=d([]),p=d({typeId:null,content:null,code:null,pageSize:10,pageNumber:1}),A=d(0);ve(()=>{F()});function F(){return b(this,null,function*(){const{data:n}=yield y.getBaseTypeList();C.value=n,C.value.length>0&&(x.value=C.value[0].code,p.value.code=C.value[0].code,yield V())})}const h=n=>{const e=C.value.find(c=>c.code===n);Q.confirm("是否删除该类型?","提示",{type:"warning"}).then(()=>b(null,null,function*(){yield y.delBaseType({id:e.id}),S.success("操作成功!"),yield F()})).catch(()=>{S.info("已取消操作!")})},ee=n=>{Q.confirm("是否删除该类型?","提示",{type:"warning"}).then(()=>b(null,null,function*(){yield y.delBaseTypeContent({id:n.id}),S.success("操作成功!"),yield V()})).catch(()=>{S.info("已取消操作!")})};function q(){o.value=!1,s.value=R({},w),g.value.resetFields(),F()}function le(n){n.validate(e=>b(null,null,function*(){e&&(_.value==="add"?yield y.addBaseType(s.value):yield y.updateBaseType(s.value),q())}))}function Z(n,e){_.value=n,n==="update"&&(s.value=e),o.value=!0}function V(){return b(this,null,function*(){const{data:n,total:e}=yield y.getBaseTypeContentList(p.value);O.value=n,A.value=e})}function M(){r.value=!1,i.value=R({},P),i.value.typeCode=x.value,L.value.resetFields(),V()}function te(n){n.validate(e=>b(null,null,function*(){e&&(D.value==="add"?yield y.addBaseTypeContent(i.value):yield y.updateBaseTypeContent(i.value),M())}))}function j(n,e){D.value=n,n==="update"&&(i.value=Object.assign({},e)),r.value=!0}const ae=n=>{p.value.code=n.props.name,i.value.typeCode=n.props.name,p.value.pageNumber=1,p.value.pageSize=10,V()};return(n,e)=>{const c=v("el-button"),ne=v("el-tag"),oe=v("el-tab-pane"),ue=v("el-tabs"),U=v("el-input"),k=v("el-table-column"),I=v("el-link"),N=v("el-form-item"),K=v("el-form"),ie=v("el-input-number");return z(),J("div",Ce,[E("div",Ve,[l(c,{class:"filter-item",type:"primary",onClick:e[0]||(e[0]=t=>Z("add"))},{default:a(()=>[...e[15]||(e[15]=[m("添加类型",-1)])]),_:1}),l(ne,{type:"primary"},{default:a(()=>[...e[16]||(e[16]=[m("双击类型标签，修改类型",-1)])]),_:1})]),l(ue,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=t=>x.value=t),type:"card",closable:"",onTabRemove:h,onTabClick:ae},{default:a(()=>[(z(!0),J(ce,null,ye(C.value,t=>(z(),ge(oe,{key:t.code,name:t.code},{label:a(()=>[E("span",{onDblclick:X=>Z("update",t)},be(t.type),41,ke)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),E("div",Te,[l(U,{modelValue:p.value.content,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value.content=t),placeholder:"请输入内容",class:"filter-item w250",clearable:""},null,8,["modelValue"]),l(c,{class:"filter-item",type:"primary",onClick:e[3]||(e[3]=t=>j("add"))},{default:a(()=>[...e[17]||(e[17]=[m("添加内容",-1)])]),_:1}),l(c,{class:"filter-item",type:"primary",onClick:V},{default:a(()=>[...e[18]||(e[18]=[m("查询",-1)])]),_:1})]),l(pe,{data:O.value,border:""},{default:a(()=>[l(k,{type:"index",label:"序号",align:"center",width:"60"}),l(k,{prop:"content",label:"类型内容",align:"center","min-width":"120"}),l(k,{prop:"code",label:"内容编码",align:"center","min-width":"120"}),l(k,{prop:"rank",label:"排序",align:"center","min-width":"150"}),l(k,{prop:"createTime",label:"创建时间",align:"center","min-width":"150"}),l(k,{label:"操作",align:"center","min-width":"140"},{default:a(({row:t})=>[l(I,{type:"primary",onClick:X=>j("update",t)},{default:a(()=>[...e[19]||(e[19]=[m("修改",-1)])]),_:1},8,["onClick"]),l(I,{type:"danger",style:{"margin-left":"8px"},onClick:X=>ee(t)},{default:a(()=>[...e[20]||(e[20]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l(me,{total:A.value,limit:p.value.pageSize,"onUpdate:limit":e[4]||(e[4]=t=>p.value.pageSize=t),page:p.value.pageNumber,"onUpdate:page":e[5]||(e[5]=t=>p.value.pageNumber=t),onPagination:V},null,8,["total","limit","page"]),l(H,{modelValue:o.value,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value=t),title:u[_.value],onClose:q},{footer:a(()=>[l(c,{onClick:q},{default:a(()=>[...e[21]||(e[21]=[m("取消",-1)])]),_:1}),l(c,{type:"primary",onClick:e[8]||(e[8]=t=>le(g.value))},{default:a(()=>[...e[22]||(e[22]=[m("确定",-1)])]),_:1})]),default:a(()=>[l(K,{ref_key:"formTypeRef",ref:g,model:s.value,rules:$,"label-width":"80px"},{default:a(()=>[l(N,{label:"类型名称",prop:"type"},{default:a(()=>[l(U,{modelValue:s.value.type,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.type=t),placeholder:"请输入类型名称"},null,8,["modelValue"])]),_:1}),l(N,{label:"类型编码",prop:"code"},{default:a(()=>[l(U,{modelValue:s.value.code,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.code=t),placeholder:"请输入类型编码(编码可为全大写英文或者全大写英文+下划线)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(H,{modelValue:r.value,"onUpdate:modelValue":e[14]||(e[14]=t=>r.value=t),title:B[D.value],onClose:M},{footer:a(()=>[l(c,{onClick:M},{default:a(()=>[...e[24]||(e[24]=[m("取消",-1)])]),_:1}),l(c,{type:"primary",onClick:e[13]||(e[13]=t=>te(L.value))},{default:a(()=>[...e[25]||(e[25]=[m("确定",-1)])]),_:1})]),default:a(()=>[l(K,{ref_key:"formContentRef",ref:L,model:i.value,"label-width":"auto",rules:W},{default:a(()=>[l(N,{label:"类型内容",prop:"content"},{default:a(()=>[l(U,{modelValue:i.value.content,"onUpdate:modelValue":e[10]||(e[10]=t=>i.value.content=t),placeholder:"请输入类型内容",clearable:""},null,8,["modelValue"])]),_:1}),l(N,{label:"类型内容编码",prop:"code"},{default:a(()=>[l(U,{modelValue:i.value.code,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.code=t),placeholder:"请输入类型内容编码"},null,8,["modelValue"])]),_:1}),l(N,{label:"排序",prop:"rank"},{default:a(()=>[l(ie,{modelValue:i.value.rank,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.rank=t),"controls-position":"right",min:1,max:1e3},null,8,["modelValue"]),e[23]||(e[23]=m(" 数字越小越靠前，默认为1 ",-1))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{xe as default};
